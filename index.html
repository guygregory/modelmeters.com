<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Azure Meter Explorer</title>
  <link rel="stylesheet" href="styles.css" />
  <link rel="preconnect" href="https://prices.azure.com" />
</head>
<body>
  <header class="app-header">
    <h1>Azure Meter Explorer <span class="badge">Preview</span></h1>
    <nav>
      <button id="themeToggle" class="btn-secondary" type="button">Theme</button>
      <a class="link" href="https://learn.microsoft.com/rest/api/cost-management/retail-prices/azure-retail-prices" target="_blank" rel="noopener">Docs ‚Üó</a>
      <a class="link" href="https://github.com" target="_blank" rel="noopener">GitHub ‚Üó</a>
    </nav>
  </header>
  <main>
    <section aria-labelledby="filtersHeading" class="panel">
      <div class="panel-head">
        <h2 id="filtersHeading">Filters</h2>
        <p class="hint">Add one or more AND clauses. Values are case-sensitive on preview API versions. Functions are substring based.</p>
      </div>
      <div class="actions-row">
        <button id="addClauseBtn" class="btn-primary" type="button">Add Clause</button>
        <button id="clearClausesBtn" class="btn-tertiary" type="button">Clear</button>
      </div>
      <div id="clauses" class="clauses" aria-live="polite"></div>
      <details class="adv">
        <summary>Advanced Options</summary>
        <div class="adv-grid">
          <label>Currency Code
            <input id="currencyCodeInput" class="form-input" maxlength="3" placeholder="USD" />
          </label>
          <label>API Version
            <select id="apiVersionSelect" class="form-input">
              <option value="">Default (stable)</option>
              <option value="2023-01-01-preview" selected>2023-01-01-preview</option>
            </select>
          </label>
          <label><input id="primaryRegionToggle" type="checkbox" /> Primary meter region only</label>
          <label>Row Limit
            <input id="rowLimitInput" class="form-input" type="number" placeholder="2000" />
          </label>
          <label>Timeout (ms)
            <input id="timeoutInput" class="form-input" type="number" placeholder="15000" />
          </label>
        </div>
      </details>
      <div class="actions-row gap">
        <button id="runBtn" class="btn-accent" type="button">Run Search</button>
        <button id="cancelBtn" class="btn-warning hide" type="button">Cancel</button>
        <button id="exportBtn" class="btn-secondary" type="button" disabled>Export CSV</button>
        <button id="copyUrlBtn" class="btn-secondary" type="button" disabled>Copy API URL</button>
      </div>
      <div id="statusBar" class="status" aria-live="polite">Idle</div>
      <div class="examples">
        <strong>Examples:</strong>
        <button class="pill ex" data-example='[{"field":"serviceName","op":"eq","value":"Virtual Machines"}]'>serviceName eq "Virtual Machines"</button>
        <button class="pill ex" data-example='[{"field":"meterName","op":"contains","value":"Standard_D2as_v5"}]'>meterName contains "Standard_D2as_v5"</button>
      </div>
    </section>
    <section aria-labelledby="resultsHeading" class="panel">
      <div class="panel-head results-head">
        <h2 id="resultsHeading">Results</h2>
        <div class="filter-visible">
          <label>Filter visible rows
            <input id="visibleFilterInput" class="form-input" placeholder="text..." />
          </label>
          <span class="mini" id="rowCount">No rows</span>
        </div>
      </div>
      <div class="table-wrap">
        <table id="resultsTable" class="data-table">
          <thead></thead>
          <tbody></tbody>
        </table>
      </div>
      <div class="actions-row center">
        <button id="loadMoreBtn" class="btn-primary" type="button" disabled>Load More</button>
      </div>
    </section>
  </main>
  <footer class="app-footer">Built client-side against Azure Retail Prices API ‚Ä¢ <span id="year"></span></footer>
  <script type="module" src="utils/csv.js"></script>
  <script type="module" src="app.js"></script>
</body>
</html>
<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Azure Meter Explorer</title>
  <meta name="description" content="Search & explore Azure Retail Prices (meter) data with dynamic filters." />
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 128 128'%3E%3Ccircle cx='64' cy='64' r='60' fill='%230059b3'/%3E%3Cpath fill='white' d='M90 38 70 90h-12L38 38h13l15 40 15-40z'/%3E%3C/svg%3E" />
  <script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>
  <link rel="stylesheet" href="styles.css" />
</head>
<body class="min-h-full bg-slate-50 dark:bg-slate-900 text-slate-900 dark:text-slate-100 flex flex-col">
<header class="border-b border-slate-200 dark:border-slate-700 bg-white/70 dark:bg-slate-800/70 backdrop-blur sticky top-0 z-30">
  <div class="mx-auto max-w-7xl px-4 py-3 flex flex-wrap gap-4 items-center justify-between">
    <h1 class="text-xl font-semibold tracking-tight flex items-center gap-2">
      <span>Azure Meter Explorer</span>
      <span class="text-xs font-normal px-2 py-0.5 rounded bg-indigo-600 text-white">Preview</span>
    </h1>
    <nav class="flex items-center gap-3 text-sm">
      <button id="themeToggle" class="px-3 py-1 rounded border border-slate-300 dark:border-slate-600 hover:bg-slate-100 dark:hover:bg-slate-700" title="Toggle dark/light mode">Theme</button>
      <a href="https://learn.microsoft.com/rest/api/cost-management/retail-prices/azure-retail-prices" target="_blank" class="px-3 py-1 rounded border border-transparent hover:bg-slate-100 dark:hover:bg-slate-700">Docs ‚Üó</a>
      <a href="https://github.com/guygregory/meter-explorer" target="_blank" class="px-3 py-1 rounded border border-transparent hover:bg-slate-100 dark:hover:bg-slate-700">GitHub ‚Üó</a>
    </nav>
  </div>
</header>
<main class="flex-1 mx-auto max-w-7xl w-full px-4 py-6 space-y-8">
  <!-- Filter Builder -->
  <section class="space-y-4" aria-labelledby="filtersHeading">
    <div class="flex flex-wrap items-end gap-4">
      <div>
        <h2 id="filtersHeading" class="text-lg font-medium">Filters</h2>
        <p class="text-xs text-slate-600 dark:text-slate-400 max-w-prose">Build one or more clauses. Values are case-sensitive on preview API versions. Functions (contains/starts/ends) are substring based.</p>
      </div>
      <div class="ml-auto flex gap-2">
        <button id="addClauseBtn" class="btn-primary">Add Clause</button>
        <button id="clearClausesBtn" class="btn-secondary" title="Clear all filter clauses">Clear</button>
      </div>
    </div>
    <div id="clauses" class="space-y-3"></div>
    <details class="group border border-slate-200 dark:border-slate-700 rounded-md p-3 bg-white/50 dark:bg-slate-800/50">
      <summary class="cursor-pointer font-medium flex items-center gap-2">Advanced Options</summary>
      <div class="mt-3 grid gap-4 sm:grid-cols-3">
        <label class="flex flex-col gap-1 text-sm">Currency Code
          <input id="currencyCodeInput" placeholder="USD" class="form-input" />
        </label>
        <label class="flex flex-col gap-1 text-sm">API Version
          <select id="apiVersionSelect" class="form-select">
            <option value="">Default</option>
            <option value="2023-01-01-preview" selected>2023-01-01-preview</option>
          </select>
        </label>
        <label class="flex items-center gap-2 text-sm mt-6"><input type="checkbox" id="primaryMetersOnly" class="form-checkbox" /> Primary meters only</label>
        <label class="flex flex-col gap-1 text-sm">Row Limit
          <input id="rowLimitInput" type="number" min="1" max="20000" value="5000" class="form-input" />
        </label>
        <label class="flex flex-col gap-1 text-sm">Timeout (s)
          <input id="timeoutInput" type="number" min="5" max="120" value="45" class="form-input" />
        </label>
      </div>
    </details>
    <div class="flex flex-wrap gap-2">
      <button id="runSearchBtn" class="btn-accent">Run Search</button>
      <button id="cancelBtn" class="btn-secondary hidden">Cancel</button>
      <button id="exportCsvBtn" class="btn-secondary" disabled>Export CSV</button>
      <button id="copyApiUrlBtn" class="btn-secondary" disabled>Copy API URL</button>
    </div>
    <div id="quickExamples" class="flex flex-wrap gap-2 text-xs"></div>
    <div id="statusBar" class="text-sm text-slate-600 dark:text-slate-400"></div>
  </section>

  <!-- Results Table -->
  <section class="space-y-3" aria-labelledby="resultsHeading">
    <div class="flex items-center gap-3">
      <h2 id="resultsHeading" class="text-lg font-medium">Results</h2>
      <div class="text-xs text-slate-500 dark:text-slate-400" id="resultCount"></div>
      <div class="ml-auto flex items-center gap-2">
        <label class="relative block text-xs"><span class="sr-only">Filter visible rows</span>
          <input id="tableQuickFilter" placeholder="Quick filter" class="form-input pl-6 py-1 text-xs" />
          <span class="absolute left-2 top-1.5 text-slate-400">üîç</span>
        </label>
      </div>
    </div>
    <div class="overflow-auto border border-slate-200 dark:border-slate-700 rounded-lg" id="tableContainer" aria-live="polite">
      <table id="resultsTable" class="min-w-full text-xs align-top">
        <thead class="bg-slate-100 dark:bg-slate-700/50 text-slate-700 dark:text-slate-200"></thead>
        <tbody class="divide-y divide-slate-100 dark:divide-slate-700"></tbody>
      </table>
    </div>
    <div class="flex justify-center">
      <button id="loadMoreBtn" class="btn-secondary hidden">Load More</button>
    </div>
  </section>
</main>
<footer class="mt-auto py-6 text-center text-xs text-slate-500 dark:text-slate-400">
  Built client-side against Azure Retail Prices API ‚Ä¢ <span id="footerYear"></span>
</footer>
<script type="module" src="app.js"></script>
</body>
</html>
